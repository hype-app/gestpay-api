<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
    <script src="http://localhost:35729/livereload.js"></script>
  </head>

  <body class="index" data-languages="[&quot;java&quot;,&quot;php&quot;,&quot;net&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="php">php</a>
              <a href="#" data-language-name="net">net</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>
<pre class="highlight xml"><code>   _____           _                     
  / ____|         | |                    
 | |  __  ___  ___| |_ _ __   __ _ _   _ 
 | | |_ |/ _ \/ __| __| '_ \ / _` | | | |
 | |__| |  __/\__ \ |_| |_) | (_| | |_| |
  \_____|\___||___/\__| .__/ \__,_|\__, |
                      | |           __/ |
                      |_|          |___/ 
</code></pre>

<p>Gestpay API documentation aims to be a comprehensive and living catalog of Gestpay services.</p>

<p>Our API is SOAP-based, so you must encode your requests in XML to communicate with Gestpay.</p>

<p>For every service, we will present both the test and the production endpoints.   </p>

<p>Our services are: </p>

<table><thead>
<tr>
<th></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><a href="/?xml#wscryptdecrypt"><code class="prettyprint">WSCryptDecrypt</code></a></td>
<td>used to start (and end) the payment process.</td>
</tr>
<tr>
<td><a href="/?xml#js_gestpay"><code class="prettyprint">js_GestPay.js</code></a></td>
<td>Mainly used to build a customized payment page.</td>
</tr>
<tr>
<td><a href="/?xml#wss2s"><code class="prettyprint">WSs2s</code></a></td>
<td>To control every aspect of your transactions and your shop.</td>
</tr>
</tbody></table>

          <h1 id="wscryptdecrypt">WSCryptDecrypt</h1>

<p>WSCryptDecrypt web service is available on production and test servers and does not require any installation on the merchant’s server.</p>

<p>The merchant must implement – in the page(s) of the virtual store configured to handle payments – a call to the webservice which handles requests to use the GestPay encryption service.</p>

<p>To request the encryption service it is necessary to call the Encrypt method.</p>

<p>If the encryption operation is concluded correctly (TransactionResult tag value with OK), the encrypted data string returned by GestPay will be available by reading the value of the CryptDecryptString tag.</p>

<p>If this is not the case, the values of the ErrorCode and ErrorDescription tag will make it possible to identify the reasons that prevented the encryption operation. To request the decryption service it is necessary to call the Decrypt method, passing the shopLogin and CryptedString tags with the values communicated by GestPay in Phase III.</p>

<p>The information containing the transaction result will be available by reading the information in the XML response file corresponding to the result of the transaction.</p>

<h2 id="encrypt">Encrypt</h2>

<blockquote>
<p>A valid <code class="prettyprint">Encrypt</code> can be called with just these fields - very easy: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985.21<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p><code class="prettyprint">Encrypt</code> is the main entrypoint for Gestpay. You must call <code class="prettyprint">Encrypt</code> either if you want to use the standard payment page, or the custom iframe solution. </p>

<p>These are the <strong>mandatory</strong> fields.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><strong><code class="prettyprint">shopLogin</code></strong></td>
<td style="text-align: center">30</td>
<td>shopLogin (Mandatory)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">uicCode</code></strong></td>
<td style="text-align: center">3</td>
<td>Code identifying currency in which transaction amount is denominated - see <a href="#currency-codes">Currency Codes</a> table - (Mandatory)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">amount</code></strong></td>
<td style="text-align: center">9</td>
<td>Transaction amount. Do not insert thousands separator. Decimals, max. 2 numbers, are optional and separator is the point (Mandatory)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">shopTransactionID</code></strong></td>
<td style="text-align: center">50</td>
<td>Identifier attributed to merchant’s transaction (Mandatory)</td>
</tr>
</tbody></table>

<blockquote>
<p>Here is an example where we use <code class="prettyprint">customInfo</code> and other non-mandatory fields. </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>1245.6<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;buyerName&gt;</span>Mario Bianchi<span class="nt">&lt;/buyerName&gt;</span>
  <span class="nt">&lt;buyerEmail&gt;</span>mario.bianchi@isp.it<span class="nt">&lt;/buyerEmail&gt;</span>
  <span class="nt">&lt;customInfo&gt;</span>BV_CODCLIENTE=12*P1*BV_SESSIONID=398<span class="nt">&lt;/customInfo&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<blockquote>
<p>The information included in <code class="prettyprint">customInfo</code> will follow this form:</p>
</blockquote>
<pre class="highlight plaintext"><code>datum1=value1*P1*datum2=value2*P1* ... *P1*datumN=valueN
</code></pre>

<blockquote>
<p>The separator between logically different information is the reserved sequence of characters <code class="prettyprint">*P1*</code>. </p>

<p>Other characters that must not be used within the parameters encoded by GestPay and in customised information are: </p>
</blockquote>
<pre class="highlight plaintext"><code>&amp;  (space)  §     (     )     * 
&lt;     &gt;     ,     ;     :    *P1* 
/     [     ]     ?     =     -- 
/*    %     //
</code></pre>

<p>These are non-mandatory fields, but are direct children of the <code class="prettyprint">Encrypt</code> root.  </p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">buyerName</code></td>
<td style="text-align: center">50</td>
<td>Buyer’s name and surname</td>
</tr>
<tr>
<td><code class="prettyprint">buyerEmail</code></td>
<td style="text-align: center">50</td>
<td>Buyer’s e-mail address</td>
</tr>
<tr>
<td><code class="prettyprint">languageId</code></td>
<td style="text-align: center">2</td>
<td>Code identifying language used in communication with buyer</td>
</tr>
<tr>
<td><code class="prettyprint">customInfo</code><sup><a href="#fn1" id="ref1">1</a></sup></td>
<td style="text-align: center">1000</td>
<td>String containing specific information as configured in the merchant’s profile</td>
</tr>
</tbody></table>

<p><sup id="fn1">1. Each field can be up to a maximum of 300 characters in length.<a href="#ref1" title="Jump back to footnote 1 in the text.">↩</a></sup></p>

<p>Information included in the <code class="prettyprint">customInfo</code> attribute is defined in the Back Office environment in the <strong>&ldquo;Fields &amp; Parameters&rdquo;</strong> section.</p>

<h3 id="requesttoken">RequestToken</h3>

<blockquote>
<p><code class="prettyprint">RequestToken</code> example we are requesting a token to store the payment data.</p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;requestToken&gt;</span>MASKEDPAN<span class="nt">&lt;/requestToken&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>You can request a token that will represent the credit card for your website. You can use it later to handle recurring payments, or to avoid your customer to insert again his credit card data. This behaviour is compliant with PCI. Read more <a href="https://hype-app.github.io/gestpay-doc/rec/handling-subscriptions.html">here</a>.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">requestToken</code> <sup><a href="#fn2" id="ref2">2</a></sup></td>
<td style="text-align: center">25</td>
<td><code class="prettyprint">MASKEDPAN</code> for a Standard Token any other value for Custom Token. Using <code class="prettyprint">:FORCED:</code> before the token, it&rsquo; s possible to have the token even if the transaction is not authorized.</td>
</tr>
</tbody></table>

<p><sup id="fn2">2. Required only when a Token is needed within the transaction response. <br> In order to be able to request, obtain and use a Token, merchants need to appropriately set “Fields and Parameters” in the dedicated section of GestPay Merchant Back Office.<a href="#ref2" title="Jump back to footnote 2 in the text.">↩</a></sup></p>

<h3 id="paymenttypes">PaymentTypes</h3>

<blockquote>
<p>If you want to enable only Credit Card or Masterpass for this payment, you can send the request like this: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span> 
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>CREDITCARD<span class="nt">&lt;/paymentType&gt;</span> 
    <span class="nt">&lt;paymentType&gt;</span>MASTERPASS<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
<span class="nt">&lt;Encrypt&gt;</span>
</code></pre>

<blockquote>
<p>If you only specify one payment type, Gestpay won&rsquo;t show the payment page but will redirect directly to the third party payment page: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span> 
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>PAYPAL<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
<span class="nt">&lt;Encrypt&gt;</span>
</code></pre>

<p>GestPay provides a way for merchants to dinamically define which payment methods must be displayed for each transaction.</p>

<p>In order to do that, merchants must properly set the tag <code class="prettyprint">paymentType</code> that can be repeated as many times as needed, inside the tag <code class="prettyprint">paymentTypes</code> (with a final “s”).</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">paymentTypes</code></td>
<td style="text-align: center"></td>
<td>container of one or more <code class="prettyprint">paymentType</code></td>
</tr>
<tr>
<td><code class="prettyprint">paymentType</code><sup><a href="#fn4" id="ref4">4</a></sup></td>
<td style="text-align: center">25</td>
<td>Set of tags to set the visibility of payment systems on payment page (see <a href="#payment-type-codes">Payment Type Codes table</a>)</td>
</tr>
</tbody></table>

<p><sup id="fn4">4. <strong>Payment Systems Visibility</strong>. In order to be able to activate the Payment Systems Visibility the merchants need to appropriately set “Fields and Parameters” in the dedicated section of GestPay Merchant Back Office. The Payment System Visibility can be configured in the specific interface in the Back Office Merchant.<a href="#ref4" title="Jump back to footnote 4 in the text.">↩</a></sup></p>

<h2 id="encrypt-result">Encrypt result</h2>

<blockquote>
<p>A succesful <code class="prettyprint">Encrypt</code> call would be like this: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;EncryptResult&gt;</span>
  <span class="nt">&lt;GestPayCryptDecrypt&gt;</span>
    <span class="nt">&lt;TransactionType&gt;</span>ENCRYPT<span class="nt">&lt;/TransactionType&gt;</span>
    <span class="nt">&lt;TransactionResult&gt;</span>OK<span class="nt">&lt;/TransactionResult&gt;</span>
    <span class="nt">&lt;CryptDecryptString&gt;</span>897543..<span class="nt">&lt;/CryptDecryptString&gt;</span>
    <span class="nt">&lt;ErrorCode&gt;</span>0<span class="nt">&lt;/ErrorCode&gt;</span>
    <span class="nt">&lt;ErrorDescription/&gt;</span>
  <span class="nt">&lt;/GestPayCryptDecrypt&gt;</span>
<span class="nt">&lt;/EncryptResult&gt;</span>
</code></pre>

<p><code class="prettyprint">Encrypt</code> web service returns back the following information in xml: </p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">TransactionType</code></td>
<td style="text-align: center">7</td>
<td>Decode the transaction type request (<code class="prettyprint">DECRYPT</code>, <code class="prettyprint">ENCRYPT</code>)</td>
</tr>
<tr>
<td><code class="prettyprint">TransactionResult</code></td>
<td style="text-align: center">2</td>
<td>Transaction result (<code class="prettyprint">OK</code>/ <code class="prettyprint">KO</code>)</td>
</tr>
<tr>
<td><code class="prettyprint">CryptDecryptString</code></td>
<td style="text-align: center">&hellip;..</td>
<td>Encrypted string get by parameter set in the xml request</td>
</tr>
<tr>
<td><code class="prettyprint">ErrorCode</code> </td>
<td style="text-align: center">9</td>
<td>Error code</td>
</tr>
<tr>
<td><code class="prettyprint">ErrorDescription</code></td>
<td style="text-align: center">255</td>
<td>Error description</td>
</tr>
</tbody></table>

<h2 id="encrypt-example-paypal">Encrypt example: Paypal</h2>

<h3 id="enabling-paypal">Enabling Paypal</h3>

<p>See <code class="prettyprint">PaymentTypes</code> example. </p>

<h3 id="show-product-info-at-paypal-39-s-buying-page">Show product info at paypal&rsquo;s buying page</h3>

<blockquote>
<p>User will see a <code class="prettyprint">Television</code> in his paypal checkout. </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>100<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span> 
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>PAYPAL<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;OrderDetails&gt;</span>
    <span class="nt">&lt;ProductDetails&gt;</span><span class="c">&lt;!-- if present, will be shown in paypal checkout --&gt;</span>
      <span class="nt">&lt;ProductDetail&gt;</span><span class="c">&lt;!-- one or more --&gt;</span>
        <span class="nt">&lt;ProductCode&gt;</span>1<span class="nt">&lt;/ProductCode&gt;</span>
        <span class="nt">&lt;SKU&gt;</span>AK-7<span class="nt">&lt;/SKU&gt;</span> 
        <span class="nt">&lt;Name&gt;</span>TV2000<span class="nt">&lt;/Name&gt;</span> 
        <span class="nt">&lt;Description&gt;</span>Television<span class="nt">&lt;/Description&gt;</span> 
        <span class="nt">&lt;Quantity&gt;</span>1<span class="nt">&lt;/Quantity&gt;</span> 
        <span class="nt">&lt;Price&gt;</span>100<span class="nt">&lt;/Price&gt;</span> 
        <span class="nt">&lt;UnitPrice&gt;</span>100<span class="nt">&lt;/UnitPrice&gt;</span> 
        <span class="nt">&lt;Type&gt;</span>1<span class="nt">&lt;/Type&gt;</span> 
        <span class="nt">&lt;Vat&gt;</span>10<span class="nt">&lt;/Vat&gt;</span> 
        <span class="nt">&lt;Discount&gt;</span>0<span class="nt">&lt;/Discount&gt;</span>
      <span class="nt">&lt;/ProductDetail&gt;</span> 
    <span class="nt">&lt;/ProductDetails&gt;</span>
  <span class="nt">&lt;/OrderDetails&gt;</span>
<span class="nt">&lt;Encrypt&gt;</span>
</code></pre>

<p>If you populate these fields accordingly, you can show your user the list of products: </p>

<table><thead>
<tr>
<th></th>
<th style="text-align: center"></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">ProductCode</code></td>
<td style="text-align: center">12</td>
<td>Article’s product Code</td>
</tr>
<tr>
<td><code class="prettyprint">SKU</code></td>
<td style="text-align: center">50</td>
<td>Article’s Stock Keeping Unit</td>
</tr>
<tr>
<td><code class="prettyprint">Name</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">100</td>
<td>Article’s name</td>
</tr>
<tr>
<td><code class="prettyprint">Description</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">255</td>
<td>Article’s description</td>
</tr>
<tr>
<td><code class="prettyprint">Quantity</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">3</td>
<td>The number of products</td>
</tr>
<tr>
<td><code class="prettyprint">Price</code></td>
<td style="text-align: center">12</td>
<td>Article’s price</td>
</tr>
<tr>
<td><code class="prettyprint">UnitPrice</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">12</td>
<td>Article’s Unit Price</td>
</tr>
<tr>
<td><code class="prettyprint">Type</code></td>
<td style="text-align: center">2</td>
<td>The type of article: 1-product, 2-shipping, 3-handling</td>
</tr>
<tr>
<td><code class="prettyprint">Vat</code></td>
<td style="text-align: center">2</td>
<td>Value-Added Tax (the value of the tax)</td>
</tr>
<tr>
<td><code class="prettyprint">Discount</code></td>
<td style="text-align: center">2</td>
<td>The amount offered by you as discount</td>
</tr>
</tbody></table>

<h3 id="paypal-seller-protection">Paypal Seller Protection</h3>

<blockquote>
<p>Paypal Seller Protection example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;ppSellerProtection&gt;</span>1<span class="nt">&lt;/ppSellerProtection&gt;</span>
  <span class="nt">&lt;shippingDetails&gt;</span>
    <span class="nt">&lt;shipToName&gt;</span>Marco Bianchi<span class="nt">&lt;/shipToName&gt;</span>
    <span class="nt">&lt;shipToStreet&gt;</span>Via Milano 1<span class="nt">&lt;/shipToStreet&gt;</span>
    <span class="nt">&lt;shipToCity&gt;</span>Torino<span class="nt">&lt;/shipToCity&gt;</span>
    <span class="nt">&lt;shipToState&gt;</span>Torino<span class="nt">&lt;/shipToState&gt;</span>
    <span class="nt">&lt;shipToCountryCode&gt;</span>IT<span class="nt">&lt;/shipToCountryCode&gt;</span>
    <span class="nt">&lt;shipToZip&gt;</span>10100<span class="nt">&lt;/shipToZip&gt;</span>
    <span class="nt">&lt;shipToStreet2/&gt;</span>
  <span class="nt">&lt;/shippingDetails&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>For more informations, checkout the <a href="https://hype-app.github.io/gestpay-doc/gs/how-gestpay-works.html">Seller Protection: Fields &amp; Parameters</a> page.</p>

<p>If you want to activate the <strong>Paypal Seller Protection</strong> you must:</p>

<ul>
<li>set <code class="prettyprint">ppSellerProtection</code> to 1</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">ppSellerProtection</code> <sup><a href="#fn3" id="ref3">3</a></sup></td>
<td style="text-align: center">1</td>
<td>Parameter to set the use of a confirmed addresses</td>
</tr>
</tbody></table>

<ul>
<li>send all the shipment data in the <code class="prettyprint">shipmentDetails</code> tag: </li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">shipToName</code></td>
<td style="text-align: center">32</td>
<td>String containing the shipping name</td>
</tr>
<tr>
<td><code class="prettyprint">shipToStreet</code></td>
<td style="text-align: center">100</td>
<td>String containing the shipping address</td>
</tr>
<tr>
<td><code class="prettyprint">shipToCity</code></td>
<td style="text-align: center">40</td>
<td>String containing the shipping city</td>
</tr>
<tr>
<td><code class="prettyprint">shipToState</code></td>
<td style="text-align: center">40</td>
<td>String containing the shipping state (see <a href="#">State Codes table - TODO</a>)</td>
</tr>
<tr>
<td><code class="prettyprint">shipToCountryCode</code></td>
<td style="text-align: center">2</td>
<td>String containing the shipping country code (see <a href="#">Country Codes table - TODO</a>)</td>
</tr>
<tr>
<td><code class="prettyprint">shipToZip</code></td>
<td style="text-align: center">20</td>
<td>String containing the shipping zip</td>
</tr>
<tr>
<td><code class="prettyprint">shipToStreet2</code></td>
<td style="text-align: center">100</td>
<td>String containing an additional shipping address field</td>
</tr>
</tbody></table>

<p><sup id="fn3">3. <strong>PayPal Seller Protection parameter</strong>. In order to be able to activate the Seller Protection Option the merchants need to appropriately set &ldquo;Fields and Parameters&rdquo; in the dedicated section of GestPay Merchant Back Office.<a href="#ref3" title="Jump back to footnote 3 in the text.">↩</a></sup></p>

<h3 id="paypal-recurring-payments"> Paypal recurring payments</h3>

<blockquote>
<p>In this way you can activate recurring payments on paypal. Note that no <code class="prettyprint">paymentType</code> is needed. </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span> 
  <span class="nt">&lt;payPalBillingAgreementDescription&gt;</span>
    description of the agreement 
  <span class="nt">&lt;/payPalBillingAgreementDescription&gt;</span>
<span class="nt">&lt;Encrypt&gt;</span>
</code></pre>

<p>A Buyer will be able to subscribe a Billing Agreement on PayPal website so authorizing the Merchant to debit his/her PayPal account in future transactions.</p>

<p>To use PayPal Reference Transaction it&rsquo;s necessary to fill the tag <code class="prettyprint">PayPalBillingAgreementDescription</code> that can be present or not (in case of a normal PayPal payment it will be left empty or not passed at all).</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">payPalBillingAgreementDescription</code></td>
<td style="text-align: center">127</td>
<td>Description of the goods, terms and conditions of the billing agreement</td>
</tr>
</tbody></table>

<p>The Encryption service, if field <code class="prettyprint">payPalBillingAgreementDescription</code> is present and not empty, assumes that the payment method is PayPal (so <code class="prettyprint">paymentType</code> field in this case is <strong>not mandatory</strong>: if present it must be valued <code class="prettyprint">PAYPAL</code>).</p>

<p>If this tag is passed to Encryption, GestPay bypasses the Pagam page in every case (even if other payment methods are enabled for the Merchant).</p>

<p>This tag has to be filled with description of the goods, terms and conditions of the billing agreement.</p>

<aside class="notice">When using paypal Billing Agreement, you will get a Token to use later with the callPagamS2S webservice. </aside>

<h2 id="encrypt-example-ideal-and-mybank">Encrypt Example: IDeal and MyBank</h2>

<blockquote>
<p>MyBank example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>MYBANK<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;paymentTypeDetail&gt;</span> 
    <span class="nt">&lt;MyBankBankCode&gt;</span>Code0000X<span class="nt">&lt;/MyBankBankCode&gt;</span>
  <span class="nt">&lt;/paymentTypeDetail&gt;</span> 
<span class="nt">&lt;/Enrcypt&gt;</span>
</code></pre>

<blockquote>
<p>IDeal example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>IDEAL<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;paymentTypeDetail&gt;</span> 
    <span class="nt">&lt;MyBankBankCode&gt;</span>Code0000Y<span class="nt">&lt;/MyBankBankCode&gt;</span>
  <span class="nt">&lt;/paymentTypeDetail&gt;</span> 
<span class="nt">&lt;/Enrcypt&gt;</span>
</code></pre>

<p>If you choose let your users pay with MyBank or IDeal, you have to compile other two fileds.</p>

<p>More details can be found in at the <a href="https://hype-app.github.io/gestpay-doc/oth/mybank.html">MyBank and IDeal</a> page.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">paymentTypeDetail</code></td>
<td style="text-align: center"></td>
<td>container of one of <code class="prettyprint">MyBankBankCode</code> or <code class="prettyprint">IdealBankCode</code></td>
</tr>
<tr>
<td><code class="prettyprint">MyBankBankCode</code><sup><a href="#fn5" id="ref5">5</a></sup></td>
<td style="text-align: center">25</td>
<td>Tag to set the Bank to show on payment page (the bank List is retrieved from <code class="prettyprint">WsS2S.CallMyBankListS2S</code>)</td>
</tr>
<tr>
<td><code class="prettyprint">IdealBankCode</code><sup><a href="#fn5" id="ref5">5</a></sup></td>
<td style="text-align: center">25</td>
<td>Tag to set the Bank to show on payment page (the bank List is retrieved from <code class="prettyprint">WsS2S.CallIdealListS2S</code>)</td>
</tr>
</tbody></table>

<p><sup id="fn5">5. <strong>paymentTypeDetail</strong>. In order to be able to activate the payment Type Detail the merchants need to appropriately set “Fields and Parameters” in the dedicated section of GestPay Merchant Back Office. The correct merchant configuration of Sofort and Ideal has to be configured in the specific interface of Back Office Merchant.(1) Each field can be up to a maximum of 300 characters in length<a href="#ref5" title="Jump back to footnote 5 in the text.">↩</a></sup></p>

<h2 id="encrypt-example-consel">Encrypt Example: Consel</h2>

<blockquote>
<p>Consel example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>CONSEL<span class="nt">&lt;/paymentType&gt;</span><span class="c">&lt;!-- select CONSEL --&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;Consel_MerchantPro&gt;</span>WIK<span class="nt">&lt;/Consel_MerchantPro&gt;</span>
  <span class="nt">&lt;Consel_CustomerInfo&gt;</span>
    <span class="nt">&lt;Surname&gt;</span>Rossi<span class="nt">&lt;/Surname&gt;</span>
    <span class="nt">&lt;Name&gt;</span>Mario<span class="nt">&lt;/Name&gt;</span> 
    <span class="nt">&lt;TaxationCode&gt;</span>RSSMRA70D23H501H<span class="nt">&lt;/TaxationCode&gt;</span> 
    <span class="nt">&lt;Address&gt;</span>Via Torino<span class="nt">&lt;/Address&gt;</span>
    <span class="nt">&lt;City&gt;</span>Roma<span class="nt">&lt;/City&gt;</span> 
    <span class="nt">&lt;StateCode&gt;</span>RM<span class="nt">&lt;/StateCode&gt;</span> 
    <span class="nt">&lt;DateAddress&gt;</span>11/04/1999<span class="nt">&lt;/DateAddress&gt;</span> 
    <span class="nt">&lt;Phone&gt;</span>0632...<span class="nt">&lt;/Phone&gt;</span> 
    <span class="nt">&lt;MobilePhone&gt;</span>331...<span class="nt">&lt;/MobilePhone&gt;</span>
  <span class="nt">&lt;/Consel_CustomerInfo&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>Here more info about <a href="https://hype-app.github.io/gestpay-doc/oth/consel-rate-in-rete.html">Consel Rate in Rete</a>.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">Consel_MerchantPro</code></td>
<td style="text-align: center">3</td>
<td>Merchant Promotional Code (Mandatory to show Consel in the pagam&rsquo;s Payment Method)</td>
</tr>
<tr>
<td><code class="prettyprint">Consel_CustomerInfo</code></td>
<td style="text-align: center"></td>
<td>Wrapper for Consel tags)</td>
</tr>
<tr>
<td><code class="prettyprint">Surname</code></td>
<td style="text-align: center">30</td>
<td>Customer Surname</td>
</tr>
<tr>
<td><code class="prettyprint">NAme</code></td>
<td style="text-align: center">30</td>
<td>Customer Name</td>
</tr>
<tr>
<td><code class="prettyprint">TaxationCode</code></td>
<td style="text-align: center">30</td>
<td>Customer Taxation Code</td>
</tr>
<tr>
<td><code class="prettyprint">Address</code></td>
<td style="text-align: center">30</td>
<td>Customer Address</td>
</tr>
<tr>
<td><code class="prettyprint">City</code></td>
<td style="text-align: center">30</td>
<td>Customer City</td>
</tr>
<tr>
<td><code class="prettyprint">StateCode</code></td>
<td style="text-align: center">30</td>
<td>Customer State Code</td>
</tr>
<tr>
<td><code class="prettyprint">DateAddress</code></td>
<td style="text-align: center">30</td>
<td>Date since the customer lives in the declared address (dd/mm/yyyy)</td>
</tr>
<tr>
<td><code class="prettyprint">Phone</code></td>
<td style="text-align: center">30</td>
<td>Customer Phone</td>
</tr>
<tr>
<td><code class="prettyprint">MobilePhone</code></td>
<td style="text-align: center">30</td>
<td>Customer Mobile phone</td>
</tr>
</tbody></table>

<h2 id="encrypt-example-sofort">Encrypt Example: Sofort</h2>

<blockquote>
<p>SOFORT example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>985<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>SOFORT<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;OrderDetails&gt;</span>
    <span class="nt">&lt;CustomerDetails&gt;</span>
      <span class="nt">&lt;FirstName&gt;</span>Albert<span class="nt">&lt;/FirstName&gt;</span>
      <span class="nt">&lt;Lastname&gt;</span>Einstein<span class="nt">&lt;Lastname&gt;</span>
      <span class="nt">&lt;PrimaryEmail&gt;</span>albert.einstein@princeton.edu<span class="nt">&lt;/PrimaryEmail&gt;</span>
    <span class="nt">&lt;/CustomerDetails&gt;</span>
    <span class="nt">&lt;BillingAddress&gt;</span>
      <span class="nt">&lt;CountryCode&gt;</span>DE<span class="nt">&lt;/CountryCode&gt;</span>
    <span class="nt">&lt;/BillingAddress&gt;</span>
  <span class="nt">&lt;/OrderDetails&gt;</span>
</code></pre>

<p>Sofort does not need mandatory parameters, but if you send the following parameters, you will jump straight to the SOFORT payment page without authenticating. All these fields are children of <code class="prettyprint">OrderDetails</code>. </p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">CustomerDetail.FirstName</code></td>
<td style="text-align: center">65</td>
<td>Customer First Name</td>
</tr>
<tr>
<td><code class="prettyprint">CustomerDetail.Lastname</code></td>
<td style="text-align: center">65</td>
<td>Customer Last name</td>
</tr>
<tr>
<td><code class="prettyprint">CustomerDetail.PrimaryEmail</code></td>
<td style="text-align: center">100</td>
<td>Customer primary email</td>
</tr>
<tr>
<td><code class="prettyprint">BillingAddress.CountryCode</code></td>
<td style="text-align: center">2</td>
<td>Alpha-2 code. For example, US is “US”</td>
</tr>
</tbody></table>

<h3 id="klarna"> Klarna</h3>

<blockquote>
<p>Here is an example of how to enable Klarna with Gestpay.</p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>100<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>S2PKLA<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;OrderDetails&gt;</span>
    <span class="nt">&lt;CustomerDetails&gt;</span>
      <span class="nt">&lt;FirstName&gt;</span>Alfred<span class="nt">&lt;/FirstName&gt;</span>
      <span class="nt">&lt;Lastname&gt;</span>Nobel<span class="nt">&lt;Lastname&gt;</span>
      <span class="nt">&lt;PrimaryEmail&gt;</span>alfred.nobel@dynamite.se<span class="nt">&lt;/PrimaryEmail&gt;</span>
      <span class="nt">&lt;SocialSecurityNumber&gt;</span>18331021+129<span class="nt">&lt;/SocialSecurityNumber&gt;</span>
    <span class="nt">&lt;/CustomerDetails&gt;</span>
    <span class="nt">&lt;BillingAddress&gt;</span>
      <span class="nt">&lt;StreetNumber&gt;</span>14<span class="nt">&lt;StreetNumber&gt;</span>
      <span class="nt">&lt;StreetName&gt;</span>Sturegatan<span class="nt">&lt;/StreetName&gt;</span>
      <span class="nt">&lt;City&gt;</span>Stockholm<span class="nt">&lt;/City&gt;</span>
      <span class="nt">&lt;ZipCode&gt;</span>SE-102<span class="nt">&lt;/ZipCode&gt;</span>
      <span class="nt">&lt;CountryCode&gt;</span>SE<span class="nt">&lt;/CountryCode&gt;</span><span class="c">&lt;!--mandatory--&gt;</span>
    <span class="nt">&lt;/BillingAddress&gt;</span>
    <span class="nt">&lt;ProductDetails&gt;</span>
      <span class="nt">&lt;ProductDetail&gt;</span><span class="c">&lt;!-- mandatory --&gt;</span>
        <span class="nt">&lt;ProductCode&gt;</span>1<span class="nt">&lt;/ProductCode&gt;</span>
        <span class="nt">&lt;SKU&gt;</span>AK-7<span class="nt">&lt;/SKU&gt;</span> 
        <span class="nt">&lt;Name&gt;</span>TV2000<span class="nt">&lt;/Name&gt;</span> 
        <span class="nt">&lt;Description&gt;</span>Television<span class="nt">&lt;/Description&gt;</span> 
        <span class="nt">&lt;Quantity&gt;</span>1<span class="nt">&lt;/Quantity&gt;</span> 
        <span class="nt">&lt;Price&gt;</span>100<span class="nt">&lt;/Price&gt;</span> 
        <span class="nt">&lt;UnitPrice&gt;</span>100<span class="nt">&lt;/UnitPrice&gt;</span> 
        <span class="nt">&lt;Type&gt;</span>1<span class="nt">&lt;/Type&gt;</span> 
        <span class="nt">&lt;Vat&gt;</span>10<span class="nt">&lt;/Vat&gt;</span> 
        <span class="nt">&lt;Discount&gt;</span>0<span class="nt">&lt;/Discount&gt;</span>
      <span class="nt">&lt;/ProductDetail&gt;</span> 
    <span class="nt">&lt;/ProductDetails&gt;</span>
  <span class="nt">&lt;/OrderDetails&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>Klarna requires only two parameters as mandatory, children of <code class="prettyprint">OrderDetails</code>: </p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">BillingAddress.CountryCode</code></td>
<td style="text-align: center">2</td>
<td>one of [AT &#124; DK &#124; FI &#124; DE &#124; NL &#124; NO &#124; SE]</td>
</tr>
<tr>
<td><code class="prettyprint">ProductDetails.ProductDetail</code></td>
<td style="text-align: center"></td>
<td>the list of ordered products</td>
</tr>
</tbody></table>

<p>If you send other fields, your customer will find them already filled: </p>

<table><thead>
<tr>
<th></th>
<th style="text-align: center"></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">CustomerDetail.FirstName</code></td>
<td style="text-align: center">65</td>
<td>Customer First Name</td>
</tr>
<tr>
<td><code class="prettyprint">CustomerDetail.Lastname</code></td>
<td style="text-align: center">65</td>
<td>the list of ordered products</td>
</tr>
<tr>
<td><code class="prettyprint">CustomerDetail.PrimaryEmail</code></td>
<td style="text-align: center">100</td>
<td>Customer primary email</td>
</tr>
<tr>
<td><code class="prettyprint">CustomerDetail.SocialSecurityNumber</code></td>
<td style="text-align: center">20</td>
<td>Customer&rsquo;s social or fiscal identifier (for Klarna Use)</td>
</tr>
<tr>
<td><code class="prettyprint">BillingAddress.StreetNumber</code></td>
<td style="text-align: center">5</td>
<td>Shipping Street Number</td>
</tr>
<tr>
<td><code class="prettyprint">BillingAddress.StreetName</code></td>
<td style="text-align: center">100</td>
<td>Shipping Street</td>
</tr>
<tr>
<td><code class="prettyprint">BillingAddress.City</code></td>
<td style="text-align: center">50</td>
<td>Billing City</td>
</tr>
<tr>
<td><code class="prettyprint">BillingAddress.ZipCode</code></td>
<td style="text-align: center">50</td>
<td>Billing Zip Code</td>
</tr>
</tbody></table>

<p><code class="prettyprint">ProductDetails</code> can have one or more <code class="prettyprint">ProductDetail</code>. Here is a description of its fields:</p>

<table><thead>
<tr>
<th></th>
<th style="text-align: center"></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">ProductCode</code></td>
<td style="text-align: center">12</td>
<td>Article’s product Code</td>
</tr>
<tr>
<td><code class="prettyprint">SKU</code></td>
<td style="text-align: center">50</td>
<td>Article’s Stock Keeping Unit</td>
</tr>
<tr>
<td><code class="prettyprint">Name</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">100</td>
<td>Article’s name</td>
</tr>
<tr>
<td><code class="prettyprint">Description</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">255</td>
<td>Article’s description</td>
</tr>
<tr>
<td><code class="prettyprint">Quantity</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">3</td>
<td>The number of products</td>
</tr>
<tr>
<td><code class="prettyprint">Price</code></td>
<td style="text-align: center">12</td>
<td>Article’s price</td>
</tr>
<tr>
<td><code class="prettyprint">UnitPrice</code> <sup><a href="#fn6" id="ref6">6</a></sup></td>
<td style="text-align: center">12</td>
<td>Article’s Unit Price</td>
</tr>
<tr>
<td><code class="prettyprint">Type</code></td>
<td style="text-align: center">2</td>
<td>The type of article: 1-product, 2-shipping, 3-handling</td>
</tr>
<tr>
<td><code class="prettyprint">Vat</code></td>
<td style="text-align: center">2</td>
<td>Value-Added Tax (the value of the tax)</td>
</tr>
<tr>
<td><code class="prettyprint">Discount</code></td>
<td style="text-align: center">2</td>
<td>The amount offered by you as discount</td>
</tr>
</tbody></table>

<p><sup id="fn6">6. <strong>Line Items</strong>: in case the buyer selects PayPal as payment method in the payment page, fields Name, Description, Quantity and UnitPrice of every occurrency of the ProductDetail tag will be used to show the transaction items details in PayPal payment page.<a href="#ref6" title="Jump back to footnote 6 in the text.">↩</a></sup></p>

<h2 id="encrypt-example-qiwi">Encrypt Example: Qiwi</h2>

<blockquote>
<p>Qiwi call example :</p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>100<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>S2PQIW<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;OrderDetails&gt;</span>
    <span class="nt">&lt;CustomerDetails&gt;</span>
      <span class="nt">&lt;PrimaryPhone&gt;</span>0123456789<span class="nt">&lt;/PrimaryPhone&gt;</span>
    <span class="nt">&lt;/CustomerDetails&gt;</span>
    <span class="nt">&lt;BillingAddress&gt;</span>
      <span class="nt">&lt;CountryCode&gt;</span>US<span class="nt">&lt;/CountryCode&gt;</span>
    <span class="nt">&lt;/BillingAddress&gt;</span>
  <span class="nt">&lt;/OrderDetails&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>Qiwi does not need mandatory parameters, but if you send these few parameters you can have a frictionless call directly to the first screen of QIWI where authentication data are asked. These fields are children of <code class="prettyprint">OrderDetails</code>:</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">CustomerDetail.PrimaryPhone</code></td>
<td style="text-align: center">20</td>
<td>Customer&rsquo;s phone including prefix</td>
</tr>
<tr>
<td><code class="prettyprint">BillingAddress.CountryCode</code></td>
<td style="text-align: center">2</td>
<td>Alpha-2 code example for US is “US”</td>
</tr>
</tbody></table>

<p>This mean that no others values are asked to the buyers; but if these field are not sent with the payment, a page will be displayed in order to ask the necessary fields like Phone and CountryCode of the buyer.</p>

<h2 id="encrypt-example-yandex">Encrypt Example: Yandex</h2>

<blockquote>
<p>Yandex Example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>100<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>S2PYAN<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;OrderDetails&gt;</span>
    <span class="nt">&lt;CustomerDetails&gt;</span>
      <span class="nt">&lt;PrimaryEmail&gt;</span>alfred.nobel@dynamite.se<span class="nt">&lt;/PrimaryEmail&gt;</span>
  <span class="nt">&lt;/OrderDetails&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>Yandex does not need mandatory parameters; but if you send  <code class="prettyprint">CustomerDetail.PrimaryEmail</code> you can have a frictionless call directly to the first screen of Yandex where authentication data are asked.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">CustomerDetail.PrimaryEmail</code></td>
<td style="text-align: center">100</td>
<td>Customer primary email</td>
</tr>
</tbody></table>

<p>This mean that no others values are asked to the buyer; if this field is not sent with the payment, a page will ask the necessary fields.</p>

<h2 id="encrypt-example-alipay">Encrypt Example: Alipay</h2>

<blockquote>
<p>Alipay example: </p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;Encrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;uicCode&gt;</span>242<span class="nt">&lt;/uicCode&gt;</span>
  <span class="nt">&lt;amount&gt;</span>100<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;shopTransactionId&gt;</span>34az85ord19<span class="nt">&lt;/shopTransactionId&gt;</span>
  <span class="nt">&lt;paymentTypes&gt;</span>
    <span class="nt">&lt;paymentType&gt;</span>S2PALI<span class="nt">&lt;/paymentType&gt;</span>
  <span class="nt">&lt;/paymentTypes&gt;</span>
  <span class="nt">&lt;OrderDetails&gt;</span>
    <span class="nt">&lt;CustomerDetails&gt;</span>
      <span class="nt">&lt;PrimaryEmail&gt;</span>alfred.nobel@dynamite.se<span class="nt">&lt;/PrimaryEmail&gt;</span>
  <span class="nt">&lt;/OrderDetails&gt;</span>
<span class="nt">&lt;/Encrypt&gt;</span>
</code></pre>

<p>Alipay does not need any mandatory parameters. Just specify the <code class="prettyprint">PaymentType</code> <code class="prettyprint">S2PALI</code> and the payment page will show to your user. </p>

<h2 id="decrypt">Decrypt</h2>

<blockquote>
<p>A <code class="prettyprint">Decrypt</code> request: </p>
</blockquote>
<pre class="highlight xml"><code> <span class="nt">&lt;Decrypt&gt;</span>
  <span class="nt">&lt;shopLogin&gt;</span>9000001<span class="nt">&lt;/shopLogin&gt;</span>
  <span class="nt">&lt;CryptedString&gt;</span>HT987YU....<span class="nt">&lt;/CryptedString&gt;</span>
 <span class="nt">&lt;/Decrypt&gt;</span>
</code></pre>

<p>GestPay communicates the payment transaction result to the merchant through an encrypted string (parameter b of the call to the url preconfigured by the merchant) with a set of transaction&rsquo;s informations.</p>

<p>To Decrypt the data it is necessary to use Decrypt method passing the following parameters, the tags&rsquo; names are case sensitive:</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">shopLogin</code></td>
<td style="text-align: center">30</td>
<td>Shop Login</td>
</tr>
<tr>
<td><code class="prettyprint">CryptedString</code></td>
<td style="text-align: center">&hellip;&hellip;</td>
<td>Encrypted string get by parameter b of the call to the url preconfigured by the merchant</td>
</tr>
</tbody></table>

<h2 id="decrypt-result">Decrypt result</h2>

<blockquote>
<p>GestPay authenticates the calling server and checks the encrypted data string. If the checks are passed, it returns an unencrypted data string containing the transaction result: </p>
</blockquote>
<pre class="highlight xml"><code> <span class="nt">&lt;DecryptResult&gt;</span>
  <span class="nt">&lt;GestPayCryptDecrypt</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>
    <span class="nt">&lt;TransactionType&gt;</span>DECRYPT<span class="nt">&lt;/TransactionType&gt;</span>
    <span class="nt">&lt;TransactionResult&gt;</span>OK<span class="nt">&lt;/TransactionResult&gt;</span>
    <span class="nt">&lt;ShopTransactionID&gt;</span>34az85ord19<span class="nt">&lt;/ShopTransactionID&gt;</span>
    <span class="nt">&lt;BankTransactionID&gt;</span>656<span class="nt">&lt;/BankTransactionID&gt;</span>
    <span class="nt">&lt;AuthorizationCode&gt;</span>983RT4<span class="nt">&lt;/AuthorizationCode&gt;</span>
    <span class="nt">&lt;Currency&gt;</span>242<span class="nt">&lt;/Currency&gt;</span>
    <span class="nt">&lt;Amount&gt;</span>985.40<span class="nt">&lt;/Amount&gt;</span>
    <span class="nt">&lt;ErrorCode&gt;</span>0<span class="nt">&lt;/ErrorCode&gt;</span>
    <span class="nt">&lt;ErrorDescription&gt;</span>Transazione correttamente effettuata<span class="nt">&lt;/ErrorDescription&gt;</span>
  <span class="nt">&lt;/GestPayCryptDecrypt&gt;</span>
<span class="nt">&lt;/DecryptResult&gt;</span>
</code></pre>

<p>Decrypt webservice returns back the following information in the xml.</p>

<p>The minimum information returned back as transaction result is marked in bold. </p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">TransactionType</code></td>
<td style="text-align: center">7</td>
<td>Decode the transaction type request (<code class="prettyprint">DECRYPT</code>, <code class="prettyprint">ENCRYPT</code>)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">TransactionResult</code></strong></td>
<td style="text-align: center"><strong>2</strong></td>
<td><strong>Transaction result (<code class="prettyprint">OK</code>/<code class="prettyprint">KO</code>)</strong></td>
</tr>
<tr>
<td><strong><code class="prettyprint">ShopTransactionID</code></strong></td>
<td style="text-align: center"><strong>50</strong></td>
<td><strong>Identifier attributed to merchant’s transaction</strong></td>
</tr>
<tr>
<td><strong><code class="prettyprint">BankTransactionID</code></strong></td>
<td style="text-align: center"><strong>9</strong></td>
<td><strong>Identifier attributed to the transaction by GestPay</strong></td>
</tr>
<tr>
<td><strong><code class="prettyprint">AuthorizationCode</code></strong></td>
<td style="text-align: center"><strong>6</strong></td>
<td><strong>Transaction authorisation code</strong></td>
</tr>
<tr>
<td><strong><code class="prettyprint">Currency</code></strong></td>
<td style="text-align: center"><strong>3</strong></td>
<td><strong>Code identifying currency in which transaction amount is denominated (see <a href="#currency-codes">Currency Codes</a> table)</strong></td>
</tr>
<tr>
<td><strong><code class="prettyprint">Amount</code></strong></td>
<td style="text-align: center"><strong>9</strong></td>
<td><strong>Transaction amount. Decimals (max. 2 numbers) are optional and separator is the point (see examples)</strong></td>
</tr>
<tr>
<td><code class="prettyprint">Country</code></td>
<td style="text-align: center">30</td>
<td>Nationality of the issuing card institute</td>
</tr>
<tr>
<td><code class="prettyprint">CustomInfo</code></td>
<td style="text-align: center">1000</td>
<td> String that has the specific information as configured in themerchant’s profile. Each field can be up to a maximum of 300 characters in length.</td>
</tr>
<tr>
<td><code class="prettyprint">Buyer.BuyerName</code></td>
<td style="text-align: center">50</td>
<td>Buyer’s name and surname</td>
</tr>
<tr>
<td><code class="prettyprint">Buyer.BuyerEmail</code></td>
<td style="text-align: center">50</td>
<td>Buyer’s e-mail address</td>
</tr>
<tr>
<td><code class="prettyprint">TDLevel</code></td>
<td style="text-align: center">255</td>
<td>Level of authentication for VBV Visa / Mastercard Securecode transactions. The string may have the value <code class="prettyprint">FULL</code> or <code class="prettyprint">HALF</code></td>
</tr>
<tr>
<td><strong><code class="prettyprint">ErrorCode</code></strong></td>
<td style="text-align: center"><strong>9</strong></td>
<td><strong>Error code</strong></td>
</tr>
<tr>
<td><strong><code class="prettyprint">ErrorDescription</code></strong></td>
<td style="text-align: center"><strong>255</strong></td>
<td><strong>Error description (localized in your language)</strong></td>
</tr>
<tr>
<td><code class="prettyprint">AlertCode</code></td>
<td style="text-align: center">9</td>
<td>Alert code</td>
</tr>
<tr>
<td><code class="prettyprint">AlertDescription</code></td>
<td style="text-align: center">255</td>
<td>Alert description in chosen language</td>
</tr>
<tr>
<td><code class="prettyprint">CVVPresent</code></td>
<td style="text-align: center">1</td>
<td>Credit Card security code flag</td>
</tr>
<tr>
<td><code class="prettyprint">MaskedPAN</code></td>
<td style="text-align: center">25</td>
<td>Masked Pan string</td>
</tr>
<tr>
<td><code class="prettyprint">PaymentMethod</code></td>
<td style="text-align: center">100</td>
<td>Indicates the used Payment Method</td>
</tr>
<tr>
<td><code class="prettyprint">TOKEN</code> </td>
<td style="text-align: center">25</td>
<td>String containing the token value</td>
</tr>
<tr>
<td><code class="prettyprint">ProductType</code></td>
<td style="text-align: center">100</td>
<td> String containing Card Type</td>
</tr>
<tr>
<td><code class="prettyprint">TokenExpiryMonth</code> </td>
<td style="text-align: center">2</td>
<td>String containing the token expiry month</td>
</tr>
<tr>
<td><code class="prettyprint">TokenExpiryYear</code></td>
<td style="text-align: center">2</td>
<td>String containing the token expiry year</td>
</tr>
<tr>
<td><code class="prettyprint">TransactionKey</code> </td>
<td style="text-align: center">18</td>
<td>Transaction identifier for 3D transactions. Not used in transactions managed with the Payment Page. It is useful only in Server-Server transactions</td>
</tr>
<tr>
<td><code class="prettyprint">VbV</code></td>
<td style="text-align: center">2</td>
<td>Verified By Visa Flag</td>
</tr>
<tr>
<td><code class="prettyprint">VbVRisp</code></td>
<td style="text-align: center"></td>
<td>Encrypted string containing information for 3D- Secure transactions. Not used in transactions managed with the Payment Page. It is useful only in Server-Server transactions</td>
</tr>
<tr>
<td><code class="prettyprint">VbVBuyer</code></td>
<td style="text-align: center">2</td>
<td>Information about the enrolment of the buyer&rsquo;s card to 3D-Secure protocol: <code class="prettyprint">OK</code> means that the card is enrolled, <code class="prettyprint">KO</code> means that the card is not enrolled</td>
</tr>
<tr>
<td><code class="prettyprint">VbVFlag</code></td>
<td style="text-align: center">2</td>
<td>Information about the 3D-Secure status. Not used in transactions managed with the Payment Page. It is useful only in Server-Server transactions.</td>
</tr>
</tbody></table>

<p>Other information is defined as optional and will be returned according to the merchant’s profile settings made in the GestPay Back Office environment.</p>

<p>A transaction result can be interpreted by verifying the <code class="prettyprint">TransactionResult</code> field value. The possible values are:</p>

<table><thead>
<tr>
<th>Transaction Result</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">OK</code> </td>
<td>Positive transaction result</td>
</tr>
<tr>
<td><code class="prettyprint">KO</code> </td>
<td>Negative transaction result</td>
</tr>
<tr>
<td><code class="prettyprint">XX</code> </td>
<td>Suspended transaction result. This is not a final result: Gestpay will send <code class="prettyprint">XX</code> when the outcome is asynchronous. Right now these systems are <code class="prettyprint">MyBank</code>, <code class="prettyprint">Sofort</code>, <code class="prettyprint">IDeal</code>, <code class="prettyprint">Bank Transfer</code>. In the future, this code might be returned with other payment systems (bitcoins, for example). <br/> A new communication will be provided to the merchant when the transaction will assume the final <code class="prettyprint">OK</code>/<code class="prettyprint">KO</code> status). <br/> <strong>If you receive a <code class="prettyprint">XX</code> code, don&rsquo;t send your goods but wait to receive the actual payment.</strong> The customer with <code class="prettyprint">XX</code> transaction is redirect to URL for positive response.</td>
</tr>
</tbody></table>

          <h1 id="js_gestpay-js">js_GestPay.js</h1>

<blockquote>
<p>To start using this feature, import the script:</p>
</blockquote>
<pre class="highlight html"><code> <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ecomm.sella.it/pagam/JavaScript/js_GestPay.js"</span>
    <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>

<blockquote>
<p>Once the script is imported, it will do some security checks. You can see this with the <code class="prettyprint">BrowserEnabled</code> variable: </p>
</blockquote>
<pre class="highlight javascript"><code><span class="k">if</span> <span class="p">(</span> <span class="nx">BrowserEnabled</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c1">//The Browser is supported! </span>
    <span class="c1">//Proceed to create the Payment page</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">//The browser is not supported </span>
    <span class="c1">//Place here error handle code</span>
<span class="p">}</span>
</code></pre>

<p>js_Gestpay.js is a javascript that enable you to process payments on your website, leaving you with the ability to completely design your custom payment page. </p>

<p>To use the following functionalities, you should first call <a href="#encrypt">`<code class="prettyprint">WSCryptDecrypt.Encrypt</code> webservice</a>. </p>

<h2 id="createpaymentpage">CreatePaymentPage</h2>

<blockquote>
<p>Syntax: </p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">GestPay</span><span class="p">.</span><span class="nx">CreatePaymentPage</span><span class="p">(</span>
    <span class="nx">MerchantCode</span><span class="p">,</span> <span class="c1">//I.E. 90000001</span>
    <span class="nx">EncryptedString</span><span class="p">,</span> <span class="c1">// "CFD3732BB102..." </span>
    <span class="nx">PaymentPageLoad</span><span class="p">);</span> <span class="c1">// a callback to call on success</span>
</code></pre>

<blockquote>
<p>Example: </p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">GestPay</span><span class="p">.</span><span class="nx">CreatePaymentPage</span><span class="p">(</span>
    <span class="s1">'9000001'</span><span class="p">,</span> 
    <span class="s1">'DcffrrnDNdjfnemfnermgnermNfdm,gnem/*ng'</span><span class="p">,</span>
    <span class="kd">function</span> <span class="p">(</span><span class="nx">Result</span><span class="p">)</span> <span class="p">{</span> 
        <span class="k">if</span><span class="p">(</span><span class="nx">Result</span><span class="p">.</span><span class="nx">ErrorCode</span> <span class="o">==</span> <span class="mi">10</span><span class="p">){</span> 
            <span class="c1">//iFrame created and payment page correctly loaded</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">//An error has occurred, check ErrorCode and ErrorDescription</span>
            <span class="c1">//properties of the Result object</span>
        <span class="p">}</span> 
    <span class="p">});</span>
</code></pre>

<p>The first thing to do to accept payments securely is to call <code class="prettyprint">GestPay.CreatePaymentPage()</code>.</p>

<p>The function will create an hidden iFrame into the body element and will load the payment page passing the merchant code and the generated encrypted string from the previous phase. </p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>Merchant Code</td>
<td><code class="prettyprint">string</code></td>
<td>the code that identifies your shop.</td>
</tr>
<tr>
<td>Encrypted String</td>
<td><code class="prettyprint">string</code></td>
<td>the string created with <code class="prettyprint">WSCryptEncrypt.Encrypt</code> webservice.</td>
</tr>
<tr>
<td>callback</td>
<td><code class="prettyprint">function</code></td>
<td>the callback that will be called with the result</td>
</tr>
</tbody></table>

<h2 id="sendpayment">SendPayment</h2>

<h3 id="credit-card-authorization">Credit card authorization</h3>

<blockquote>
<p>syntax: </p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">GestPay</span><span class="p">.</span><span class="nx">SendPayment</span> <span class="p">({</span> 
        <span class="na">CC</span> <span class="p">:</span> <span class="s1">''</span><span class="p">,</span> 
        <span class="na">EXPMM</span> <span class="p">:</span><span class="s1">''</span><span class="p">,</span> 
        <span class="na">EXPYY</span> <span class="p">:</span><span class="s1">''</span>
        <span class="p">[,</span><span class="na">CVV2</span><span class="p">:</span><span class="s1">''</span><span class="p">]</span> <span class="c1">//optional </span>
    <span class="p">},</span>
    <span class="nx">callBackObj</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>example:</p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">GestPay</span><span class="p">.</span><span class="nx">SendPayment</span><span class="p">({</span>
        <span class="na">CC</span> <span class="p">:</span> <span class="s1">'44444444444444444'</span><span class="p">,</span> 
        <span class="na">EXPMM</span> <span class="p">:</span> <span class="s1">'11'</span><span class="p">,</span>
        <span class="na">EXPYY</span> <span class="p">:</span> <span class="s1">'14'</span> 
    <span class="p">},</span>
    <span class="kd">function</span> <span class="p">(</span><span class="nx">Result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">Result</span><span class="p">.</span><span class="nx">ErroCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//Transaction correctly processed</span>
            <span class="c1">//Decrypt the Result.EncryptedString property to read the </span>
            <span class="c1">//transaction result</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">//An error has occurred, check ErrorCode and ErrorDescription </span>
            <span class="c1">//properties of the Result object</span>
        <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p>To send the credit card data to the hidden iFrame, the checkout page will assign a function to the <code class="prettyprint">OnSubimt</code> event of the credit card form, this function will retrieve the credit card data and will call the <code class="prettyprint">GestPay.SendPayment</code> method providing an object with the credit card number (<code class="prettyprint">CC</code>), the expiration month (<code class="prettyprint">EXPMM</code>) and the expiration year (<code class="prettyprint">EXPYY</code>), the CVV (<code class="prettyprint">CVV2</code>) if enabled, and a CallBack object. </p>

<p>The input is composed of two arguments: </p>

<ul>
<li>The object <code class="prettyprint">CCData</code>, with these fields</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Size</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">CC</code></td>
<td>Credit card number</td>
<td><code class="prettyprint">number</code></td>
<td>min: 13, max: 19</td>
</tr>
<tr>
<td><code class="prettyprint">EXPMM</code></td>
<td>Expiration Month</td>
<td><code class="prettyprint">number</code></td>
<td>2</td>
</tr>
<tr>
<td><code class="prettyprint">EXPYY</code></td>
<td>Expiration Year</td>
<td><code class="prettyprint">number</code></td>
<td>2</td>
</tr>
<tr>
<td><code class="prettyprint">CVV2</code> (optional)</td>
<td>Cvv/4DBC</td>
<td><code class="prettyprint">number</code></td>
<td>min:3, max:4</td>
</tr>
</tbody></table>

<ul>
<li>a callback function, to handle the output. </li>
</ul>

          <h1 id="wss2s">WsS2S</h1>

<aside class="notice">This error section is stored in a separate file in `includes/_errors.md`. Slate allows you to optionally separate out your docs into many files&hellip;just save them to the `includes` folder and add them to the top of your `index.md`&rsquo;s frontmatter. Files are included in the order listed.</aside>

<p>WSCryptDecrypt web service is available on production and test servers and does not require any installation on the merchant’s server.</p>

<p>The merchant must implement – in the page(s) of the virtual store configured to handle payments – a call to the webservice which handles requests to use the GestPay encryption service.</p>

<p>To request the encryption service it is necessary to call the Encrypt method.</p>

<p>If the encryption operation is concluded correctly (TransactionResult tag value with OK), the encrypted data string returned by GestPay will be available by reading the value of the CryptDecryptString tag.</p>

<p>If this is not the case, the values of the ErrorCode and ErrorDescription tag will make it possible to identify the reasons that prevented the encryption operation. To request the decryption service it is necessary to call the Decrypt method, passing the shopLogin and CryptedString tags with the values communicated by GestPay in Phase III.</p>

<p>The information containing the transaction result will be available by reading the information in the XML response file corresponding to the result of the transaction.</p>

<h2 id="encrypt"> Encrypt</h2>

<p>Some of the information to communicate to GestPay is required in order to complete the payment process, while other information can be omitted without compromising the processing of the transaction. Through the GestPay Back Office environment, merchants can define what information is required and what information is optional.</p>

<p>Some information that is essential to the payment process is configured as compulsory by GestPay. This attributes cannot be modified.</p>

<p>The following table gives the information that must be communicated to GestPay xml using Encrypt method in order to make a transaction, the tags&rsquo; names are case sensitive.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">max length</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td><strong><code class="prettyprint">shopLogin</code></strong></td>
<td style="text-align: center">30</td>
<td>shopLogin (Mandatory)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">uicCode</code></strong></td>
<td style="text-align: center">3</td>
<td>Code identifying currency in which transaction amount is denominated - see Currency Codes table TODO - (Mandatory)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">amount</code></strong></td>
<td style="text-align: center">9</td>
<td>Transaction amount. Do not insert thousands separator. Decimals, max. 2 numbers, are optional and separator is the point (Mandatory)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">shopTransactionID</code></strong></td>
<td style="text-align: center">50</td>
<td>Identifier attributed to merchant’s transaction (Mandatory)</td>
</tr>
<tr>
<td><code class="prettyprint">buyerName</code></td>
<td style="text-align: center">50</td>
<td>Buyer’s name and surname</td>
</tr>
<tr>
<td><code class="prettyprint">buyerEmail</code></td>
<td style="text-align: center">50</td>
<td>Buyer’s e-mail address</td>
</tr>
<tr>
<td><code class="prettyprint">languageId</code></td>
<td style="text-align: center">2</td>
<td>Code identifying language used in communication with buyer</td>
</tr>
<tr>
<td><code class="prettyprint">customInfo</code><sup><a href="#fn1" id="ref1">1</a></sup></td>
<td style="text-align: center">1000</td>
<td>String containing specific information as configured in the merchant’s profile</td>
</tr>
<tr>
<td><code class="prettyprint">requestToken</code> <sup><a href="#fn2" id="ref2">2</a></sup></td>
<td style="text-align: center">25</td>
<td>“MASKEDPAN” for a Standard Token any other value for Custom Token. Using :FORCED: before the token, it&rsquo; s possible to have the token even if the transaction is not authorized.</td>
</tr>
<tr>
<td><code class="prettyprint">ppSellerProtection</code> <sup><a href="#fn3" id="ref3">2</a></sup></td>
<td style="text-align: center">1</td>
<td>Parameter to set the use of a confirmed addresses</td>
</tr>
<tr>
<td><code class="prettyprint">shippingDetails</code>:</td>
<td style="text-align: center"></td>
<td></td>
</tr>
<tr>
<td>alhoa</td>
<td style="text-align: center"></td>
<td></td>
</tr>
</tbody></table>

<p><sup id="fn1">1. Each field can be up to a maximum of 300 characters in length.<a href="#ref1" title="Jump back to footnote 1 in the text.">↩</a></sup></p>

<p><sup id="fn2">2. Required only when a Token is needed within the transaction response. <br> In order to be able to request, obtain and use a Token, merchants need to appropriately set “Fields and Parameters” in the dedicated section of GestPay Merchant Back Office.<a href="#ref2" title="Jump back to footnote 2 in the text.">↩</a></sup></p>

<p><sup id="fn3">3. <strong>PayPal Seller Protection parameter</strong>. In order to be able to activate the Seller Protection Option the merchants need to appropriately set &ldquo;Fields and Parameters&rdquo; in the dedicated section of GestPay Merchant Back Office.<a href="#ref3" title="Jump back to footnote 3 in the text.">↩</a></sup></p>

<p><sup id="fn4">4. <strong>Payment Systems Visibility</strong>. In order to be able to activate the Payment Systems Visibility the merchants need to appropriately set “Fields and Parameters” in the dedicated section of GestPay Merchant Back Office. The Payment System Visibility can be configured in the specific interface in the Back Office Merchant.<a href="#ref4" title="Jump back to footnote 4 in the text.">↩</a></sup></p>

<p><sup id="fn5">5. <strong>paymentTypeDetail</strong>. In order to be able to activate the payment Type Detail the merchants need to appropriately set “Fields and Parameters” in the dedicated section of GestPay Merchant Back Office. The correct merchant configuration of Sofort and Ideal has to be configured in the specific interface of Back Office Merchant.(1) Each field can be up to a maximum of 300 characters in length<a href="#ref5" title="Jump back to footnote 5 in the text.">↩</a></sup></p>

<p><sup id="fn6">6. <strong>Line Items</strong>: in case the buyer selects PayPal as payment method in the payment page, fields Name, Description, Quantity and UnitPrice of every occurrency of the ProductDetail tag will be used to show the transaction items details in PayPal payment page.<a href="#ref6" title="Jump back to footnote 6 in the text.">↩</a></sup></p>

<h2 id="decrypt">Decrypt</h2>

          <h1 id="errors">Errors</h1>

<aside class="notice">This error section is stored in a separate file in `includes/_errors.md`. Slate allows you to optionally separate out your docs into many files&hellip;just save them to the `includes` folder and add them to the top of your `index.md`&rsquo;s frontmatter. Files are included in the order listed.</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>418</td>
<td>I&rsquo;m a teapot</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

          <h1 id="payment-type-codes">Payment Type Codes</h1>

<table><thead>
<tr>
<th><strong>PaymentType</strong></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong><code class="prettyprint">BON</code></strong></td>
<td>Money Transfer</td>
</tr>
<tr>
<td><strong><code class="prettyprint">CREDITCARD</code></strong></td>
<td>Credit Card</td>
</tr>
<tr>
<td><strong><code class="prettyprint">PAYPAL</code></strong></td>
<td>Paypal</td>
</tr>
<tr>
<td><strong><code class="prettyprint">MYBANK</code></strong></td>
<td>MyBank</td>
</tr>
<tr>
<td><strong><code class="prettyprint">UPMOBILE</code></strong></td>
<td>Mobile - QRCode</td>
</tr>
<tr>
<td><strong><code class="prettyprint">MASTERPASS</code></strong></td>
<td>MasterPass</td>
</tr>
<tr>
<td><strong><code class="prettyprint">CONSEL</code></strong></td>
<td>Consel</td>
</tr>
<tr>
<td><strong><code class="prettyprint">S2PALI</code></strong></td>
<td>Alipay (Alternatives)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">S2PKLA</code></strong></td>
<td>Klarna (Alternatives)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">S2PQIW</code></strong></td>
<td>Qiwi (Alternatives)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">S2PYAN</code></strong></td>
<td>Yandex (Alternatives)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">S2PSOF</code></strong></td>
<td>Sofort (Alternatives)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">S2PIDE</code></strong></td>
<td>Ideal (Alternatives)</td>
</tr>
<tr>
<td><strong><code class="prettyprint">COMPASS</code></strong></td>
<td>Compass C-pay</td>
</tr>
<tr>
<td><strong><code class="prettyprint">SOFORT</code></strong></td>
<td>SOFORT</td>
</tr>
<tr>
<td><strong><code class="prettyprint">IDEAL</code></strong></td>
<td>IDEAL</td>
</tr>
</tbody></table>

<p>For more informations about payment types, read <a href="https://hype-app.github.io/gestpay-doc/oth/what-does-it-really-mean-that-gestpay-is-a-payment-gateway.html">the docs</a>. </p>

          <h1 id="currency-codes">Currency Codes</h1>

<p>Currency codes are handled by GestPay using the currency attribute.</p>

<table><thead>
<tr>
<th>UIC code</th>
<th style="text-align: center">ISO code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">109</code></td>
<td style="text-align: center">AUD</td>
<td>Australia Dollar</td>
</tr>
<tr>
<td><code class="prettyprint">234</code></td>
<td style="text-align: center">BRL</td>
<td>Brazil Real</td>
</tr>
<tr>
<td><code class="prettyprint">12</code></td>
<td style="text-align: center">CAD</td>
<td>Canada Dollar</td>
</tr>
<tr>
<td><code class="prettyprint">3</code></td>
<td style="text-align: center">CHF</td>
<td>Switzerland Franc</td>
</tr>
<tr>
<td><code class="prettyprint">144</code></td>
<td style="text-align: center">CNY</td>
<td>China Yuan Renminbi</td>
</tr>
<tr>
<td><code class="prettyprint">223</code></td>
<td style="text-align: center">CZK</td>
<td>Czech Republic Koruna</td>
</tr>
<tr>
<td><code class="prettyprint">7</code></td>
<td style="text-align: center">DKK</td>
<td>Denmark Krone</td>
</tr>
<tr>
<td><code class="prettyprint">242</code></td>
<td style="text-align: center">EUR</td>
<td>Euro Member Countries</td>
</tr>
<tr>
<td><code class="prettyprint">2</code></td>
<td style="text-align: center">GBP</td>
<td>United Kingdom Pound</td>
</tr>
<tr>
<td><code class="prettyprint">103</code></td>
<td style="text-align: center">HKD</td>
<td>Hong Kong Dollar</td>
</tr>
<tr>
<td><code class="prettyprint">153</code></td>
<td style="text-align: center">HUF</td>
<td>Hungary Forint</td>
</tr>
<tr>
<td><code class="prettyprint">71</code></td>
<td style="text-align: center">JPY</td>
<td>Japan Yen</td>
</tr>
<tr>
<td><code class="prettyprint">8</code></td>
<td style="text-align: center">NOK</td>
<td>Norway Krone</td>
</tr>
<tr>
<td><code class="prettyprint">237</code></td>
<td style="text-align: center">PLN</td>
<td>Poland Zloty</td>
</tr>
<tr>
<td><code class="prettyprint">244</code></td>
<td style="text-align: center">RUB</td>
<td>Russian Ruble</td>
</tr>
<tr>
<td><code class="prettyprint">9</code></td>
<td style="text-align: center">SEK</td>
<td>Sweden Krona</td>
</tr>
<tr>
<td><code class="prettyprint">124</code></td>
<td style="text-align: center">SGD</td>
<td>Singapore Dollar</td>
</tr>
<tr>
<td><code class="prettyprint">1</code></td>
<td style="text-align: center">USD</td>
<td>United States Dollar</td>
</tr>
</tbody></table>

          <h1 id="paypal-country-codes">Paypal Country Codes</h1>

<p>You can find all the Country Codes that are supported by Paypal at <a href="https://developer.paypal.com/docs/classic/api/country_codes/">this link</a>. </p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="php">php</a>
                <a href="#" data-language-name="net">net</a>
          </div>
      </div>
    </div>
  </body>
</html>
